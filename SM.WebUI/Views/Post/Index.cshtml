@model SM.Core.ViewModel.PostListViewModel

@{
    ViewBag.Title = "Index";
}

<head>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<h2>Index</h2>

<p>
    @Html.ActionLink("Create New", "Create")
</p>

<table class="table">
    @*<tr>

        <th>
            @Html.DisplayNameFor(model => model.Posts.Title)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Posts.Description)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Posts.Image)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Posts.Category)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Posts.NumberOfLikes)
        </th>
        <th></th>
    </tr>*@

    @foreach (var item in Model.Posts)
    {
        <tr>

            <td>
                @Html.DisplayFor(modelItem => item.Title)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Description)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Image)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Category)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NumberOfLikes)
            </td>
            <td id="likesForm">
                @*<input type="text" name="PostID" value="@item.Id" />
                <button id="btnLikes" type="button">Like</button>*@
                <button onclick="Edit('@item.Id',true)">Like</button>
            </td>

            <td>
                @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                @Html.ActionLink("Delete", "Delete", new { id = item.Id })
            </td>
        </tr>
    }

</table>

<script>

    function Edit(id,like) {
            $.ajax({
                type:"post",
                data:{ id: id, like: like },
                url:'Likes'
            }).done(function (result) {
                var html = ""
                for (var i = 0; i < result.length; i++) {
                    html += '<tr><td>' + result[i].id + '</td><td>' + result[i].numberOfLikes + '</td><td><button onclick="Edit(' + result[i].id + ',true)">Like</button></td></tr>'
                }
                document.getElementsByClassName("table").innerHTML = html;
            });
        }
     @*$("#btnLikes").click(function ()
    {
        $.ajax({
            url: "@Url.Action("EditLikes","Index")",
            type:"post",
            data: $("#likesForm").serialize()
        }).done(function (response) {
           /* debugger;*/
            if (response.Success) {
                window.location.reload();
            }
            else {
                swal("Error!", response.Message, "error");
            }
        }).fail(function () {
            swal("Error!", "Error Occured.Please Try Again", "error")
        });
    });*@

</script>
